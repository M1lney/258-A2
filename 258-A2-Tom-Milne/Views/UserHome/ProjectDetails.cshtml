@model _258_A2_Tom_Milne.Models.ProjectViewModel

@{
    ViewData["Title"] = "Project Details";
    Layout = "_LayoutUser";
    var projectId = Model.ProjectId;

}

<head>
    <link rel="stylesheet" href="~/css/ProjectDetailsStyle.css" />
</head>

<h4>@Model.Project.Title</h4>
<p>@Model.Project.Description</p>
<p>Finish Date: @Model.Project.Date.ToShortDateString()</p>

<h5>Project Tasks</h5>
<div>
    @foreach (var task in Model.ProjectTasks)
    {
        <div class="card" style="margin-bottom: 10px">
            <div class="card-body">
                <div class="row" style="border-bottom: 1px solid #ccc;">
                    <div class="col-md-6">
                        <h5 class="card-title">@task.Title</h5>
                    </div>
                    <div class="col-md-6">
                        <p class="card-text"><strong>Due Date:</strong> @task.Date.ToString("MMM dd, yyyy")</p>
                    </div>
                </div>
                <div class="col-md-12">
                    <h6>Description:</h6>
                    <textarea readonly ="readonly" class="form-control" id="taskDescription_@task.Id">@task.Description</textarea>
                    <button class="btn btn-primary" id="editTaskButton" task-id="@task.Id">Edit</button>
                </div>

            </div>
        </div>
    }
</div>

<button id="toggleForm" class="btn btn-primary">Add Project Task</button>

@Html.Partial("_CreateTaskForm", new _258_A2_Tom_Milne.Models.ProjectTask { ProjectId = projectId })

<script>document.getElementById("toggleForm").addEventListener("click", function () {
        const form = document.getElementById("projectTaskForm");
        if (form.style.display === "none" || form.style.display === "") {
            form.style.display = "block";
        } else {
            form.style.display = "none";
        }
    });</script>


<script>
    const editButtons = document.querySelectorAll('button[task-id]');

    editButtons.forEach(button => {
        button.addEventListener('click', () => {
            const taskId = button.getAttribute('task-id');
            const description = document.getElementById(`taskDescription_${taskId}`);

            if (description.readOnly) {
                description.readOnly = false;
                button.textContent = 'Save';
            } else {
                description.readOnly = true;
                button.textContent = 'Edit';
            }
        });
    });
</script>


